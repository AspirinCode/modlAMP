<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>modlamp.sequences &mdash; modlAMP v2.5.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'v2.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/modlamp.ico"/>
    <link rel="top" title="modlAMP v2.5.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">modlAMP v2.5.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for modlamp.sequences</h1><div class="highlight"><pre>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. currentmodule:: modlamp.sequences</span>

<span class="sd">.. moduleauthor:: modlab Alex Mueller ETH Zurich &lt;alex.mueller@pharma.ethz.ch&gt;</span>

<span class="sd">This module incorporates different classes to generate peptide sequences with different characteristics from scratch.</span>
<span class="sd">The following classes are available:</span>

<span class="sd">============================        ===============================================================================</span>
<span class="sd">Class                               Characteristics</span>
<span class="sd">============================        ===============================================================================</span>
<span class="sd">:py:class:`Random`                  Generates random sequences with a specified amino acid distribution.</span>
<span class="sd">:py:class:`Helices`                 Generates presumed amphipathic helical sequences with a hydrophobic moment.</span>
<span class="sd">:py:class:`Kinked`                  Generates presumed amphipathic helices with a kink (Pro residue).</span>
<span class="sd">:py:class:`Oblique`                 Generates presumed oblique oriented sequences in presence of libid membranes.</span>
<span class="sd">:py:class:`Centrosymmetric`         Generates centrosymmetric sequences with a symmetry axis.</span>
<span class="sd">:py:class:`MixedLibrary`            Generates a mixed library of sequences of all other classes.</span>
<span class="sd">:py:class:`Hepahelices`             Generates presumed amphipathic helices with a heparin-binding-domain.</span>
<span class="sd">:py:class:`AMPngrams`               Generates sequences from most frequent ngrams in the APD3.</span>
<span class="sd">:py:class:`HelicesACP`              Generates sequences with the amino acid probabiliy of helical ACPs.</span>
<span class="sd">:py:class:`AmphipathicArc`          Generates presumed amphipathic helices with controlled hydrophobic arc size.</span>
<span class="sd">============================        ===============================================================================</span>

<span class="sd">.. note:: During the process of sequence generation, duplicates are only removed for the :py:class:`MixedLibrary`</span>
<span class="sd">    class. To remove duplicates, call the class methods :py:func:`self.filter_duplicates()`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">core</span> <span class="kn">import</span> <span class="n">mutate_AA</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">,</span> <span class="n">clean</span><span class="p">,</span> <span class="n">save_fasta</span><span class="p">,</span> <span class="n">keep_natural_aa</span><span class="p">,</span> <span class="n">filter_unnatural</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">filter_aa</span><span class="p">,</span> \
    <span class="n">filter_duplicates</span><span class="p">,</span> <span class="n">ngrams_apd</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;modlab&quot;</span>
<span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;restructuredtext en&quot;</span>


<div class="viewcode-block" id="Random"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random">[docs]</a><span class="k">class</span> <span class="nc">Random</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for random peptide sequences</span>
<span class="sd">    This class incorporates methods for generating peptide random peptide sequences of defined length.</span>
<span class="sd">    The amino acid probabilities can be chosen from different probabilities:</span>

<span class="sd">    - **rand**: equal probabilities for all amino acids</span>
<span class="sd">    - **AMP**: amino acid probabilities taken from the antimicrobial peptide database `APD3 &lt;http://aps.unmc.edu/AP/statistic/statistic.php&gt;`_, March 17, 2016, containing 2674 sequences.</span>
<span class="sd">    - **AMPnoCM**: same amino acid probabilities as **AMP** but lacking Cys and Met (for synthesizability)</span>
<span class="sd">    - **randnoCM**: equal probabilities for all amino acids, except 0.0 for both Cys and Met (for synthesizability)</span>

<span class="sd">    The probability values for all natural AA can be found in the following table:</span>

<span class="sd">    ===  ====    ======    =========    ==========</span>
<span class="sd">    AA   rand    AMP       AMPnoCM      randnoCM</span>
<span class="sd">    ===  ====    ======    =========    ==========</span>
<span class="sd">    A    0.05    0.0766    0.0812275    0.05555555</span>
<span class="sd">    C    0.05    0.071     0.0          0.0</span>
<span class="sd">    D    0.05    0.026     0.0306275    0.05555555</span>
<span class="sd">    E    0.05    0.0264    0.0310275    0.05555555</span>
<span class="sd">    F    0.05    0.0405    0.0451275    0.05555555</span>
<span class="sd">    G    0.05    0.1172    0.1218275    0.05555555</span>
<span class="sd">    H    0.05    0.021     0.0256275    0.05555555</span>
<span class="sd">    I    0.05    0.061     0.0656275    0.05555555</span>
<span class="sd">    K    0.05    0.0958    0.1004275    0.05555555</span>
<span class="sd">    L    0.05    0.0838    0.0884275    0.05555555</span>
<span class="sd">    M    0.05    0.0123    0.0          0.0</span>
<span class="sd">    N    0.05    0.0386    0.0432275    0.05555555</span>
<span class="sd">    P    0.05    0.0463    0.0509275    0.05555555</span>
<span class="sd">    Q    0.05    0.0251    0.0297275    0.05555555</span>
<span class="sd">    R    0.05    0.0545    0.0591275    0.05555555</span>
<span class="sd">    S    0.05    0.0613    0.0659275    0.05555555</span>
<span class="sd">    T    0.05    0.0455    0.0501275    0.05555555</span>
<span class="sd">    V    0.05    0.0572    0.0618275    0.05555555</span>
<span class="sd">    W    0.05    0.0155    0.0201275    0.05555555</span>
<span class="sd">    Y    0.05    0.0244    0.0290275    0.05555555</span>
<span class="sd">    ===  ====    ======    =========    ==========</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Random.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimal sequence length</span>
<span class="sd">        :param lenmax: maximal sequence length</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: initialized class attributes for sequence number and length</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="Random.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proba</span><span class="o">=</span><span class="s1">&#39;rand&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to actually generate the sequences.</span>

<span class="sd">        :param proba: AA probability to be used to generate sequences. Available: AMP, AMPnoCM, rand, randnoCM</span>
<span class="sd">        :return: A list of random AMP sequences with defined AA probabilities</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; r = Random(5,20,6)</span>
<span class="sd">        &gt;&gt;&gt; r.generate_sequences(proba=&#39;AMP&#39;)</span>
<span class="sd">        &gt;&gt;&gt; r.sequences</span>
<span class="sd">        [&#39;CYGALWHIFV&#39;,&#39;NIVRHHAPSTVIK&#39;,&#39;LCPNPILGIV&#39;,&#39;TAVVRGKESLTP&#39;,&#39;GTGSVCKNSCRGRFGIIAF&#39;,&#39;VIIGPSYGDAEYA&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_rand</span>  <span class="c1"># default probability = rand</span>
        <span class="k">if</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;AMPnoCM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_AMPnoCM</span>
        <span class="k">elif</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;AMP&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_AMP</span>
        <span class="k">elif</span> <span class="n">proba</span> <span class="o">==</span> <span class="s1">&#39;randnoCM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_randnoCM</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span>
                                                 <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">))</span>  <span class="c1"># weighed random selection of amino acid, probabilities = prob</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="Random.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta formatted file.</span>

<span class="sd">        :param filename: output filename in which the sequences from :py:attr:`sequences` are safed in fasta format.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a fasta file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Random.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; H.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="Random.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Random.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Random.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Random.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Random.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Helices"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices">[docs]</a><span class="k">class</span> <span class="nc">Helices</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for peptide sequences probable to form helices.</span>

<span class="sd">    This class incorporates methods for generating presumed amphipathic alpha-helical peptide sequences.</span>
<span class="sd">    These sequences are generated by placing basic residues along the sequence with distance 3-4 AA to each other.</span>
<span class="sd">    The remaining empty spots are filled up by hydrophobic AAs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Helices.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimal sequence length</span>
<span class="sd">        :param lenmax: maximal sequence length</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: defined variables as instances</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="Helices.generate_helices"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.generate_helices">[docs]</a>    <span class="k">def</span> <span class="nf">generate_helices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate amphipathic helical sequences with class features defined in :class:`Helices()`</span>

<span class="sd">        :return: In the attribute :py:attr:`sequences`: a list of sequences with presumed amphipathic helical structure.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; h = Helices(7,21,5)</span>
<span class="sd">        &gt;&gt;&gt; h.generate_helices()</span>
<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;KGIKVILKLAKAGVKAVRL&#39;,&#39;IILKVGKV&#39;,&#39;IAKAGRAIIK&#39;,&#39;LKILKVVGKGIRLIVRIIKAL&#39;,&#39;KAGKLVAKGAKVAAKAIKI&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">basepos</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># select spot for first basic residue from 0 to 3</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place first basic residue</span>
            <span class="n">gap</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">next</span>  <span class="c1"># gap cycle of 3 &amp; 4 --&gt; 3,4,3,4,3,4...</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">g</span> <span class="o">+</span> <span class="n">basepos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="n">seq</span><span class="p">):</span>  <span class="c1"># place more basic residues 3-4 positions further (changing between distance 3 and 4)</span>
                <span class="n">basepos</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place more basic residues</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="p">()</span>  <span class="c1"># next gap</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)):</span>
                <span class="k">while</span> <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>  <span class="c1"># fill up remaining spots with hydrophobic AAs</span>
                    <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="Helices.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; H.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="Helices.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta formatted file.</span>

<span class="sd">        :param filename: output filename in which the sequences from :py:attr:`sequences` are safed in fasta format.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a fasta file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Helices.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Helices.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Helices.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Helices.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Helices.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Kinked"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked">[docs]</a><span class="k">class</span> <span class="nc">Kinked</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for peptide sequences probable to form helices with a kink.</span>
<span class="sd">    This class incorporates methods for presumed kinked amphipathic alpha-helical peptide sequences:</span>
<span class="sd">    Sequences are generated by placing basic residues along the sequence with distance 3-4 AA to each other.</span>
<span class="sd">    The remaining spots are filled up by hydrophobic AAs. Then, a basic residue is replaced by proline, presumably</span>
<span class="sd">    leading to a kink in the hydrophobic face of the amphipathic helices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Kinked.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">,</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimal sequence length</span>
<span class="sd">        :param lenmax: maximal sequence length</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: defined attributes :py:attr:`lenmin`, :py:attr:`lenmax` and :py:attr:`seqnum`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="Kinked.generate_kinked"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.generate_kinked">[docs]</a>    <span class="k">def</span> <span class="nf">generate_kinked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to actually generate the presumed kinked sequences with features defined in the class instances.</span>

<span class="sd">        :return: sequence list with strings stored in the attribute :py:attr:`sequences`</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; k = Kinked(7,28,8)</span>
<span class="sd">        &gt;&gt;&gt; k.generate_kinked()</span>
<span class="sd">        &gt;&gt;&gt; k.sequences</span>
<span class="sd">        [&#39;IILRLHPIG&#39;,&#39;ARGAKVAIKAIRGIAPGGRVVAKVVKVG&#39;,&#39;GGKVGRGVAFLVRIILK&#39;,&#39;KAVKALAKGAPVILCVAKVI&#39;,</span>
<span class="sd">        &#39;IGIRVWRAVIKVIPVAVRGLRL&#39;,&#39;RIGRVIVPVIRGL&#39;,&#39;AKAARIVAMLAR&#39;,&#39;LGAKGWRLALKGIPAAIKLGKV&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="n">poslist</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># used to</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">basepos</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># select spot for first basic residue from 0 to 3</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place first basic residue</span>
            <span class="n">poslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">basepos</span><span class="p">)</span>
            <span class="n">gap</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">next</span>  <span class="c1"># gap cycle of 3 &amp; 4 --&gt; 3,4,3,4,3,4...</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">g</span> <span class="o">+</span> <span class="n">basepos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="n">seq</span><span class="p">):</span>  <span class="c1"># place more basic residues 3-4 positions further (changing between distance 3 and 4)</span>
                <span class="n">basepos</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place more basic residues</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="p">()</span>  <span class="c1"># next gap</span>
                <span class="n">poslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">basepos</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)):</span>
                <span class="k">while</span> <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>  <span class="c1"># fill up remaining spots with hydrophobic AAs</span>
                    <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>

            <span class="c1"># place proline around the middle of the sequence</span>
            <span class="n">propos</span> <span class="o">=</span> <span class="n">poslist</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">poslist</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">propos</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="Kinked.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; S.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; S.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; S.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="Kinked.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta formatted file.</span>

<span class="sd">        :param filename: output filename in which the sequences from :py:attr:`sequences` are safed in fasta format.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a fasta file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Kinked.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Kinked.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Kinked.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Kinked.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Kinked.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Oblique"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique">[docs]</a><span class="k">class</span> <span class="nc">Oblique</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for oblique sequences with a so called linear hydrophobicity gradient.</span>

<span class="sd">    This class incorporates methods for generating peptide sequences with a linear hydrophobicity gradient, meaning that</span>
<span class="sd">    these sequences have a hydrophobic tail. This feature gives rise to the hypothesis that they orient themselves</span>
<span class="sd">    tilted/oblique in membrane environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Oblique.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimal sequence length</span>
<span class="sd">        :param lenmax: maximal sequence length</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: defined attributes :py:attr:`lenmin`, :py:attr:`lenmax` and :py:attr:`seqnum`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="Oblique.generate_oblique"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.generate_oblique">[docs]</a>    <span class="k">def</span> <span class="nf">generate_oblique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate the possible oblique sequences.</span>

<span class="sd">        :return: A list of sequences in the attribute :py:attr:`sequences`.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; o = Oblique(10,30,4)</span>
<span class="sd">        &gt;&gt;&gt; o.generate_oblique()</span>
<span class="sd">        &gt;&gt;&gt; o.sequences</span>
<span class="sd">        [&#39;GLLKVIRIAAKVLKVAVLVGIIAI&#39;,&#39;AIGKAGRLALKVIKVVIKVALILLAAVA&#39;,&#39;KILRAAARVIKGGIKAIVIL&#39;,&#39;VRLVKAIGKLLRIILRLARLAVGGILA&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">basepos</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># select spot for first basic residue from 0 to 3</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place first basic residue</span>
            <span class="n">gap</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">next</span>  <span class="c1"># gap cycle of 3 &amp; 4 --&gt; 3,4,3,4,3,4...</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">g</span> <span class="o">+</span> <span class="n">basepos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="n">seq</span><span class="p">):</span>  <span class="c1"># place more basic residues 3-4 positions further (changing between distance 3 and 4)</span>
                <span class="n">basepos</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">seq</span><span class="p">[</span><span class="n">basepos</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>  <span class="c1"># place more basic residues</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">gap</span><span class="p">()</span>  <span class="c1"># next gap</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)):</span>
                <span class="k">while</span> <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>  <span class="c1"># fill up remaining spots with hydrophobic AAs</span>
                    <span class="n">seq</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="n">seq</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># transform last 3rd of sequence into hydrophobic ones --&gt; hydrophobicity gradient = oblique</span>
                <span class="n">seq</span><span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="Oblique.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; H.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="Oblique.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta formatted file.</span>

<span class="sd">        :param filename: output filename in which the sequences from :py:attr:`sequences` are safed in fasta format.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a fasta file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Oblique.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Oblique.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Oblique.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Oblique.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Oblique.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Centrosymmetric"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric">[docs]</a><span class="k">class</span> <span class="nc">Centrosymmetric</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for peptide sequences produced out of 7 AA centro-symmetric blocks yielding peptides of length</span>
<span class="sd">    14 or 21 AA (2*7 or 3*7).</span>

<span class="sd">    This class incorporates methods to generate special peptide sequences with an overall presumed</span>
<span class="sd">    hydrophobic moment. Sequences are generated by centro-symmetric blocks of seven amino acids. Two or three blocks</span>
<span class="sd">    are added to build a final sequence of length 14 or 21 amino acids length. If the method :func:`generate_symmetric()`</span>
<span class="sd">    is used, two or three identical blocks are concatenated. If the method :func:`generate_asymmetric()` is used,</span>
<span class="sd">    two or three different blocks are concatenated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Centrosymmetric.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqnum</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: defined number of sequences to generate, empty list to store produced sequences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.generate_symmetric"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.generate_symmetric">[docs]</a>    <span class="k">def</span> <span class="nf">generate_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The :func:`generate_symmetric()` method generates overall symmetric sequences out of two or three blocks of</span>
<span class="sd">        identical centro-symmetric sequence blocks of 7 amino acids. The resulting sequence presumably has a large</span>
<span class="sd">        hydrophobic moment.</span>

<span class="sd">        :return: In the attribute :py:attr:`sequences`: centro-symmetric peptide sequences of the form [h,+,h,a,h,+,h] with</span>
<span class="sd">            h = hydrophobic AA, + = basic AA, a = anchor AA (F,Y,W,(P)), sequence length is 14 or 21 AA</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; s = Centrosymmetric(5)</span>
<span class="sd">        &gt;&gt;&gt; s.generate_symmetric()</span>
<span class="sd">        &gt;&gt;&gt; s.sequences</span>
<span class="sd">        [&#39;ARIFIRAARIFIRA&#39;,&#39;GRIYIRGGRIYIRGGRIYIRG&#39;,&#39;IRGFGRIIRGFGRIIRGFGRI&#39;,&#39;GKAYAKGGKAYAKG&#39;,&#39;AKGYGKAAKGYGKAAKGYGKA&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># iterate over number of sequences to generate</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># number of sequence blocks to take (2 or 3)</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>  <span class="c1"># template sequence AA list with length 7</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>  <span class="c1"># generate symmetric sequence block of 7 AA with an anchor in the middle</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">seq</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_anchor</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.generate_asymmetric"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.generate_asymmetric">[docs]</a>    <span class="k">def</span> <span class="nf">generate_asymmetric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The :func:`generate_asymmetric()` method generates overall asymmetric sequences out of two or three blocks of</span>
<span class="sd">        different centro-symmetric sequence blocks of 7 amino acids. The resulting sequence presumably has a large</span>
<span class="sd">        hydrophobic    moment.</span>

<span class="sd">        :return: In the attribute :py:attr:`sequences`: a list of peptide sequences as strings of length 14 or 21</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; S = Centrosymmetric(5)</span>
<span class="sd">        &gt;&gt;&gt; S.generate_asymmetric()</span>
<span class="sd">        &gt;&gt;&gt; S.sequences</span>
<span class="sd">        [&#39;GRLFLRGAKGFGKAVRVWVRV&#39;,&#39;IKGWGKILKLYLKL&#39;,&#39;LKAYAKLVKAWAKVLRLFLRL&#39;,&#39;IRLWLRIIKAFAKI&#39;,&#39;LRIFIRLVKLWLKVIRLWLRI&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># iterate over number of sequences to generate</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># number of sequence blocks to take (2 or 3)</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>  <span class="c1"># template sequence AA list with length 7</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>  <span class="c1"># generate symmetric sequence block of 7 AA with an anchor in the middle</span>
                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">seq</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_anchor</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">))</span></div>

<div class="viewcode-block" id="Centrosymmetric.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; S.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; S.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; S.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta formatted file.</span>

<span class="sd">        :param filename: output filename in which the sequences from :py:attr:`sequences` are safed in fasta format.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a fasta file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Centrosymmetric.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Centrosymmetric.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AmphipathicArc"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc">[docs]</a><span class="k">class</span> <span class="nc">AmphipathicArc</span><span class="p">:</span>
    <span class="c1"># TODO: add test cases</span>
    <span class="sd">&quot;&quot;&quot;Base class for generating positively-charged amphipathic peptide sequences based on an alpha-helix pattern with</span>
<span class="sd">    different arc sizes.</span>

<span class="sd">    The probability values for the Hydrophobic and Polar positions of the helix can be found in the following table:</span>

<span class="sd">    ===   ====   =====</span>
<span class="sd">    AA    Hydr   Polar</span>
<span class="sd">    ===   ====   =====</span>
<span class="sd">    A     0.00   0.05</span>
<span class="sd">    C     0.00   0.00</span>
<span class="sd">    D     0.00   0.05</span>
<span class="sd">    E     0.00   0.05</span>
<span class="sd">    F     0.20   0.00</span>
<span class="sd">    G     0.00   0.05</span>
<span class="sd">    H     0.00   0.05</span>
<span class="sd">    I     0.20   0.00</span>
<span class="sd">    K     0.00   0.25</span>
<span class="sd">    L     0.20   0.00</span>
<span class="sd">    M     0.00   0.00</span>
<span class="sd">    N     0.00   0.05</span>
<span class="sd">    P     0.00   0.05</span>
<span class="sd">    Q     0.00   0.05</span>
<span class="sd">    R     0.00   0.25</span>
<span class="sd">    S     0.00   0.05</span>
<span class="sd">    T     0.00   0.05</span>
<span class="sd">    V     0.20   0.00</span>
<span class="sd">    W     0.20   0.00</span>
<span class="sd">    Y     0.00   0.05</span>
<span class="sd">    ===   ====   =====</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AmphipathicArc.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimum sequence length</span>
<span class="sd">        :param lenmax: maximum sequence length</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: defined attributes :py:attr:`lenmin`, :py:attr:`lenmax`and :py:attr:`seqnum`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="AmphipathicArc.generate_arc"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.generate_arc">[docs]</a>    <span class="k">def</span> <span class="nf">generate_arc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arcsize</span><span class="o">=</span><span class="s1">&#39;160&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate the possible amphipathic helices with defined hydrophobic arc sizes.</span>
<span class="sd">        :param arcsize: {str} to choose among &#39;80&#39;, &#39;120&#39;, &#39;160&#39;, &#39;200&#39;, &#39;240&#39;.</span>
<span class="sd">        :return: A list of sequences in the attribute :py:attr:`sequences`.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; amphi_hel = Amphipathic_arc(10,25,4)</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel.generate_arc(&#39;80&#39;)</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel.sequences</span>

<span class="sd">        [&#39;YLYANLRQE&#39;, &#39;GVKPRIK&#39;, &#39;RWKKKVKDSVKDFEKRFKDIEKRIQRKLA&#39;, &#39;KIKEQLRNSVSGWHRN&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_amphihel</span>

        <span class="k">if</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="s1">&#39;80&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="s1">&#39;120&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="s1">&#39;160&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="s1">&#39;200&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">arcsize</span> <span class="o">==</span> <span class="s1">&#39;240&#39;</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;Arc size unknown, choose among: &#39;80&#39;, &#39;120&#39;, &#39;160&#39;, &#39;200&#39;, &#39;240&#39;.&quot;</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">icycle</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">next</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">icycle</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">icycle</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="AmphipathicArc.generate_mixed_arcs"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.generate_mixed_arcs">[docs]</a>    <span class="k">def</span> <span class="nf">generate_mixed_arcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to generate sequences of mixed arc sizes.</span>
<span class="sd">        :return: A list of sequences in :py:attr:`sequences`</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; amphi_hel = Amphipathic_arc(7,30,10)</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel.generate_mixed_arcs()</span>
<span class="sd">        &gt;&gt;&gt; amphi_hel.sequences</span>

<span class="sd">        [&#39;KIRRAFRNNLK&#39;, &#39;PFWKRWARWFKRWHRKLKTVFAKVTALL&#39;, &#39;AVFRTIKAVF&#39;, &#39;AIVHFFLTFLAELWQFLK&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_amphihel</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="n">idxcycle</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">next</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idxcycle</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">icycle</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">next</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">icycle</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">icycle</span><span class="p">()</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">idxcycle</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="AmphipathicArc.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta file.</span>

<span class="sd">        :param filename: output filename in which sequences from :py:attr:`sequences` are saved.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers.</span>
<span class="sd">        :return: a fasta file containing the generated sequences.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="AmphipathicArc.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; H.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="AmphipathicArc.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="AmphipathicArc.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="AmphipathicArc.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="AmphipathicArc.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AmphipathicArc.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Duplicate** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HelicesACP"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP">[docs]</a><span class="k">class</span> <span class="nc">HelicesACP</span><span class="p">:</span>
    <span class="c1"># TODO: add test cases</span>
    <span class="sd">&quot;&quot;&quot;Base class for peptides sequences with the amino acid probability of alpha-helical ACPs.</span>

<span class="sd">    This class incorporates methods for generating presumed alpha-helical peptides with the amino acid probability</span>
<span class="sd">    distribution of alpha-helical ACPs. For each of the positions in the helix (1-18) the amino acid distribution among</span>
<span class="sd">    62 anuran and hymenopteran alpha-helical ACPs was computed and is used to design the new sequences</span>
<span class="sd">    (Gabernet et al., MedChemComm 2016).</span>

<span class="sd">    ==  =====   =====   =====   =====   =====   =====   =====   =====   =====   =====</span>
<span class="sd">    AA  pos0    pos1 	pos2 	pos3 	pos4 	pos5 	pos6 	pos7 	pos8 	pos9</span>
<span class="sd">    ==  =====   =====   =====   =====   =====   =====   =====   =====   =====   =====</span>
<span class="sd">    A 	0.048 	0.000 	0.000 	0.048 	0.016 	0.129 	0.032 	0.097 	0.193 	0.500</span>
<span class="sd">    C 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000</span>
<span class="sd">    D 	0.000 	0.016 	0.000 	0.274 	0.017 	0.000 	0.000 	0.016 	0.000 	0.000</span>
<span class="sd">    E 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.064 	0.000 	0.016</span>
<span class="sd">    F 	0.161 	0.048 	0.306 	0.000 	0.048 	0.000 	0.000 	0.016 	0.000	0.016</span>
<span class="sd">    G 	0.645 	0.000 	0.177 	0.145 	0.000 	0.016 	0.258 	0.113 	0.064 	0.081</span>
<span class="sd">    H 	0.000 	0.000 	0.000 	0.016 	0.000 	0.000 	0.016 	0.000 	0.032 	0.000</span>
<span class="sd">    I 	0.048 	0.113 	0.016 	0.081 	0.338 	0.274 	0.000 	0.048 	0.145	0.064</span>
<span class="sd">    K 	0.000 	0.032 	0.016 	0.129 	0.129 	0.000 	0.387 	0.338 	0.048 	0.032</span>
<span class="sd">    L 	0.048 	0.710 	0.129 	0.048 	0.096 	0.322 	0.210 	0.064	0.113 	0.064</span>
<span class="sd">    M 	0.000 	0.016 	0.016 	0.048 	0.016 	0.032 	0.000 	0.000 	0.000 	0.000</span>
<span class="sd">    N 	0.000 	0.016 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.016 	0.000</span>
<span class="sd">    P 	0.000 	0.000 	0.145 	0.016 	0.032 	0.016 	0.000 	0.000	0.000 	0.000</span>
<span class="sd">    Q 	0.000 	0.000 	0.016 	0.016 	0.000 	0.000 	0.016 	0.000 	0.016 	0.000</span>
<span class="sd">    R 	0.000 	0.016 	0.016 	0.000 	0.016 	0.000 	0.016 	0.000 	0.016 	0.016</span>
<span class="sd">    S 	0.016 	0.000 	0.016 	0.129 	0.032 	0.032 	0.048 	0.177 	0.000 	0.032</span>
<span class="sd">    T 	0.016 	0.016 	0.000 	0.016 	0.048 	0.016 	0.000 	0.016 	0.000 	0.016</span>
<span class="sd">    V 	0.016 	0.016 	0.016 	0.016 	0.209 	0.161 	0.016 	0.048 	0.338 	0.161</span>
<span class="sd">    W 	0.000 	0.000 	0.129 	0.016 	0.000 	0.000 	0.000 	0.000 	0.016 	0.000</span>
<span class="sd">    Y 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000 	0.000</span>
<span class="sd">    ==  =====   =====   =====   =====   =====   =====   =====   =====   =====   =====</span>

<span class="sd">    ==  =====   =====   =====   =====   =====   =====   =====   =====</span>
<span class="sd">    AA  pos10   pos11   pos12   pos13   pos14   pos15 	pos16 	pos17</span>
<span class="sd">    ==  =====   =====   =====   =====   =====   =====   =====   =====</span>
<span class="sd">    A 	0.048   0.113   0.100   0.185   0.078   0.120   0.170   0.167</span>
<span class="sd">    C 	0.016   0.000   0.000   0.000   0.000   0.000   0.024   0.194</span>
<span class="sd">    D 	0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000</span>
<span class="sd">    E 	0.048   0.016   0.000   0.019   0.000   0.000   0.000   0.000</span>
<span class="sd">    F 	0.000   0.097   0.067   0.019   0.000   0.020   0.146   0.000</span>
<span class="sd">    G 	0.225   0.032   0.067   0.204   0.137   0.100   0.000   0.055</span>
<span class="sd">    H 	0.000   0.210   0.000   0.000   0.000   0.160   0.000   0.000</span>
<span class="sd">    I 	0.032   0.065   0.183   0.000   0.000   0.100   0.268   0.000</span>
<span class="sd">    K 	0.419   0.081   0.000   0.037   0.294   0.040   0.024   0.028</span>
<span class="sd">    L 	0.032   0.032   0.283   0.240   0.039   0.280   0.073   0.222</span>
<span class="sd">    M 	0.000   0.000   0.033   0.000   0.020   0.020   0.000   0.000</span>
<span class="sd">    N 	0.032   0.000   0.000   0.000   0.020   0.020   0.000   0.000</span>
<span class="sd">    P 	0.016   0.000   0.000   0.130   0.176   0.000   0.000   0.000</span>
<span class="sd">    Q 	0.000   0.016   0.000   0.019   0.000   0.000   0.000   0.000</span>
<span class="sd">    R 	0.016   0.016   0.000   0.019   0.019   0.000   0.049   0.000</span>
<span class="sd">    S 	0.096   0.048   0.017   0.000   0.157   0.100   0.000   0.056</span>
<span class="sd">    T 	0.016   0.113   0.000   0.019   0.039   0.020   0.000   0.056</span>
<span class="sd">    V 	0.000   0.145   0.250   0.111   0.020   0.020   0.220   0.222</span>
<span class="sd">    W 	0.000   0.000   0.000   0.000   0.000   0.000   0.024   0.000</span>
<span class="sd">    Y 	0.000   0.016   0.000   0.000   0.000   0.000   0.000   0.000</span>
<span class="sd">    ==  =====   =====   =====   =====   =====   =====   =====   =====</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="HelicesACP.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimal sequence length.</span>
<span class="sd">        :param lenmax: maximal sequence length.</span>
<span class="sd">        :param seqnum: number of seqeunces to generate.</span>
<span class="sd">        :return: initialized class attributes for sequence number and length.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="HelicesACP.generate_helices"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.generate_helices">[docs]</a>    <span class="k">def</span> <span class="nf">generate_helices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate the sequences with the mentioned amino acid probabilities.</span>
<span class="sd">        :return: A list of potentially helical peptides with the amino acid distribution of ACP helical peptides</span>
<span class="sd">        according to the position in the helix wheel.</span>

<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; helACP = Helix_ACP(7,18,4)</span>
<span class="sd">        &gt;&gt;&gt; helACP.generate_helices()</span>
<span class="sd">        &gt;&gt;&gt; helACP.sequences</span>

<span class="sd">        [&#39;FLFDVAKKVAGTALT&#39;, &#39;GLGIILGAGG&#39;, &#39;GLRIKLGVWAKKA&#39;, &#39;GFWGFIKTI&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_ACPhel</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))):</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">18</span><span class="o">*</span><span class="p">(</span><span class="n">l</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span>  <span class="c1"># for helices &gt;18aa, the probabilities start from the beginning again</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AAs</span><span class="p">,</span>
                                                 <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[:,</span> <span class="n">l</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="HelicesACP.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a fasta file.</span>

<span class="sd">        :param filename: output filename in which sequences from :py:attr:`sequences` are saved.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers.</span>
<span class="sd">        :return: a fasta file containing the generated sequences.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="HelicesACP.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;IAKAGRAIIK&#39;]</span>
<span class="sd">        &gt;&gt;&gt; H.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; H.sequences</span>
<span class="sd">        [&#39;NAKAGRAWIK&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="HelicesACP.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="HelicesACP.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="HelicesACP.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="HelicesACP.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.HelicesACP.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Duplicate** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MixedLibrary"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary">[docs]</a><span class="k">class</span> <span class="nc">MixedLibrary</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for holding a virtual peptide library.</span>

<span class="sd">    This class :class:`MixedLibrary` incorporates methods to generate a virtual peptide library composed out of different</span>
<span class="sd">    sub-libraries. The available library subtypes are all from the classes :class:`Centrosymmetric`, :class:`Helices`,</span>
<span class="sd">    :class:`Kinked`, :class:`Oblique` or :class:`Random`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="MixedLibrary.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">centrosymmetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">centroasymmetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">helix</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kinked</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">oblique</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rand</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">randAMP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">randAMPnoCM</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initializing method of the class :class:`MixedLibrary`. Except from **number**, all other parameters are</span>
<span class="sd">        ratios of sequences of the given sequence class.</span>

<span class="sd">        :param number: number of sequences to be generated</span>
<span class="sd">        :param centrosymmetric: ratio of symmetric centrosymmetric sequences in the library</span>
<span class="sd">        :param centroasymmetric: ratio of asymmetric centrosymmetric sequences in the library</span>
<span class="sd">        :param helix: ratio of amphipathic helical sequences in the library</span>
<span class="sd">        :param kinked: ratio of kinked amphipathic helical sequences in the library</span>
<span class="sd">        :param oblique: ratio of oblique oriented amphipathic helical sequences in the library</span>
<span class="sd">        :param rand: ratio of random sequneces in the library</span>
<span class="sd">        :param randAMP: ratio of random sequences with APD2 amino acid distribution in the library</span>
<span class="sd">        :param randAMPnoCM: ratio of random sequences with APD2 amino acid distribution without Cys and Met in the library</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If duplicate sequences are created, these are removed during the creation process. It is therefore quite</span>
<span class="sd">            probable that you will not get the exact size of library that you entered as the parameter **number**. If you</span>
<span class="sd">            generate a small library, it can also happen that the size is bigger than expected, because ratios are rounded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">centrosymmetric</span><span class="p">,</span> <span class="n">centroasymmetric</span><span class="p">,</span> <span class="n">helix</span><span class="p">,</span> <span class="n">kinked</span><span class="p">,</span> <span class="n">oblique</span><span class="p">,</span> <span class="n">rand</span><span class="p">,</span> <span class="n">randAMP</span><span class="p">,</span> <span class="n">randAMPnoCM</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">centrosymmetric</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;asy&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">centroasymmetric</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span>
                       <span class="s1">&#39;hel&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">helix</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;knk&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">kinked</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;obl&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">oblique</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span>
                       <span class="s1">&#39;ran&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">rand</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;AMP&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">randAMP</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="s1">&#39;nCM&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">randAMPnoCM</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;asy&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;hel&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;knk&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;obl&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;ran&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;AMP&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
                     <span class="s1">&#39;nCM&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libsize</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">))}</span></div>

<div class="viewcode-block" id="MixedLibrary.generate_library"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.generate_library">[docs]</a>    <span class="k">def</span> <span class="nf">generate_library</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method generates a virtual sequence library with the subtype ratios initialized in class :class:`MixedLibrary()`.</span>
<span class="sd">        All sequences are between 7 and 28 amino acids in length.</span>

<span class="sd">        :return: a virtual library of sequences in the attribute :py:attr:`sequences`, the sub-library class names in</span>
<span class="sd">            :py:attr:`names`, the number of sequences generated for each class in :py:attr:`nums` and the library size in</span>
<span class="sd">            :py:attr:`libsize`.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; lib = MixedLibrary(10000,centrosymmetric=5,centroasymmetric=5,helix=3,kinked=3,oblique=2,rand=10,</span>
<span class="sd">        randAMP=10,randAMPnoCM=5)</span>
<span class="sd">        &gt;&gt;&gt; lib.generate_library()</span>
<span class="sd">        &gt;&gt;&gt; lib.libsize  # as duplicates were present, the library does not have the size that was sepecified</span>
<span class="sd">        9126</span>
<span class="sd">        &gt;&gt;&gt; lib.sequences</span>
<span class="sd">        [&#39;RHTHVAGSWYGKMPPSPQTL&#39;,&#39;MRIKLRKIPCILAC&#39;,&#39;DGINKEVKDSYGVFLK&#39;,&#39;LRLYLRLGRVWVRG&#39;,&#39;GKLFLKGGKLFLKGGKLFLKG&#39;,...]</span>
<span class="sd">        &gt;&gt;&gt; lib.nums</span>
<span class="sd">        {&#39;AMP&#39;: 2326,</span>
<span class="sd">        &#39;asy&#39;: 1163,</span>
<span class="sd">        &#39;hel&#39;: 698,</span>
<span class="sd">        &#39;knk&#39;: 698,</span>
<span class="sd">        &#39;nCM&#39;: 1163,</span>
<span class="sd">        &#39;obl&#39;: 465,</span>
<span class="sd">        &#39;ran&#39;: 2326,</span>
<span class="sd">        &#39;sym&#39;: 1163}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Cs</span> <span class="o">=</span> <span class="n">Centrosymmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">])</span>
        <span class="n">Cs</span><span class="o">.</span><span class="n">generate_symmetric</span><span class="p">()</span>
        <span class="n">Ca</span> <span class="o">=</span> <span class="n">Centrosymmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">])</span>
        <span class="n">Ca</span><span class="o">.</span><span class="n">generate_asymmetric</span><span class="p">()</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">Helices</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">])</span>
        <span class="n">H</span><span class="o">.</span><span class="n">generate_helices</span><span class="p">()</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">Kinked</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">])</span>
        <span class="n">K</span><span class="o">.</span><span class="n">generate_kinked</span><span class="p">()</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">Oblique</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">])</span>
        <span class="n">O</span><span class="o">.</span><span class="n">generate_oblique</span><span class="p">()</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">])</span>
        <span class="n">R</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="s1">&#39;rand&#39;</span><span class="p">)</span>
        <span class="n">Ra</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">])</span>
        <span class="n">Ra</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="s1">&#39;AMP&#39;</span><span class="p">)</span>
        <span class="n">Rc</span> <span class="o">=</span> <span class="n">Random</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">])</span>
        <span class="n">Rc</span><span class="o">.</span><span class="n">generate_sequences</span><span class="p">(</span><span class="s1">&#39;AMPnoCM&#39;</span><span class="p">)</span>

        <span class="c1"># TODO: update libnums according to real numbers</span>

        <span class="n">sequences</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">Ca</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">H</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">K</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">O</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">Ra</span><span class="o">.</span><span class="n">sequences</span> <span class="o">+</span> <span class="n">Rc</span><span class="o">.</span><span class="n">sequences</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;asy&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;hel&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;knk&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;obl&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;ran&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;AMP&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">[</span><span class="s1">&#39;nCM&#39;</span><span class="p">]</span>
        <span class="c1"># combining sequence and name to remove duplicates</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sequences</span><span class="p">):</span>
            <span class="n">comb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">comb</span><span class="p">)</span>
        <span class="c1"># remove duplicates</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># update libsize and nums</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libsize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>  <span class="c1"># update the number of sequences for every class</span></div>

<div class="viewcode-block" id="MixedLibrary.prune_library"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.prune_library">[docs]</a>    <span class="k">def</span> <span class="nf">prune_library</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newsize</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to cut down a library to the given new size.</span>

<span class="sd">        :param newsize: new desired size of the mixed library</span>
<span class="sd">        :return: adapted library with corresponding attributes (sequences, names, libsize, nums)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[:</span><span class="n">newsize</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">[:</span><span class="n">newsize</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libsize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>  <span class="c1"># update the number of sequences for every class</span></div>

<div class="viewcode-block" id="MixedLibrary.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to save generated sequences in a .fasta formatted file.</span>

<span class="sd">        :param filename: output filename in which the sequences from :py:attr:`sequences` are safed in fasta format.</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a fasta file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="MixedLibrary.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div>

<div class="viewcode-block" id="MixedLibrary.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.MixedLibrary.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Hepahelices"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices">[docs]</a><span class="k">class</span> <span class="nc">Hepahelices</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for peptide sequences probable to form helices and include a heparin-binding-domain.</span>

<span class="sd">    This class is used to construct presumed amphipathic helices that include a heparin-binding-domain (HBD)</span>
<span class="sd">    probable to bind heparin. The HBD sequence for alpha-helices usually has the following form: **XBBBXXBX**</span>
<span class="sd">    (B: basic AA; X: hydrophobic, uncharged AA, with mainly Ser &amp; Gly).</span>

<span class="sd">    More on the HBD: Munoz, E. M. &amp; Linhardt, R. J. Heparin-Binding Domains in Vascular Biology. *Arterioscler. Thromb.</span>
<span class="sd">    Vasc. Biol.* **24**, 1549–1557 (2004).</span>

<span class="sd">    .. versionadded:: v2.3.1</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Hepahelices.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param lenmin: minimal sequence length, minimal 8!</span>
<span class="sd">        :param lenmax: maximal sequence length, maximal 50!</span>
<span class="sd">        :param seqnum: number of sequences to generate</span>
<span class="sd">        :return: defined variables as instances</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aminoacids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lenmin</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">or</span> <span class="n">lenmax</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;Wrong sequence length.</span><span class="se">\n</span><span class="s2">Minimum: 8</span><span class="se">\n</span><span class="s2">Maximum: 50&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lenmin</span><span class="p">,</span> <span class="n">lenmax</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hepahelices.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate helical sequences with class features defined in :class:`Hepahelices()`</span>

<span class="sd">        :return: In the attribute :py:attr:`sequences`: a list of sequences including a heparin-binding-domain.</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; h = Hepahelices(8,21,10)  # minimal length: 8, maximal length: 50</span>
<span class="sd">        &gt;&gt;&gt; h.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;GRLARSLKRKLNRLVRGGGRLVRGGG&#39;, &#39;IRSIRRRLSKLARSLGRGARSLGRG&#39;, &#39;RAVKRKVNKLLKGAAKVLKGAAKVLKGAAK&#39;, ... ]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>  <span class="c1"># for the number of sequences to generate</span>
            <span class="c1"># generate heparin binding domain with the from HBBBHPBH (H: hydrophobic, B: basic, P: polar)</span>
            <span class="n">hbd</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_polar</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span>
            <span class="c1"># generate amphipathic block to add in front of HBD</span>
            <span class="n">bef</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])]</span>
            <span class="c1"># generate amphipathic block to add after HBD</span>
            <span class="n">aft</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span> <span class="o">+</span> \
                  <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_basic</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AA_hyd</span><span class="p">)]</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lenmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># total sequence length</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">8</span>  <span class="c1"># remaining empty positions in sequence</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>  <span class="c1"># positions before HBD</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">b</span>  <span class="c1"># positions after HBD</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">bef</span> <span class="o">+</span> <span class="n">hbd</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">aft</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="mi">21</span> <span class="o">-</span> <span class="n">b</span><span class="p">:</span> <span class="mi">29</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># if sequence length is 8, take HBD as whole sequence</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="n">hbd</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span></div>

<div class="viewcode-block" id="Hepahelices.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;IRSIRRRLSKLARSLGRGARSLGRG&#39;]</span>
<span class="sd">        &gt;&gt;&gt; h.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;IRSIRRRKSKLARQLGRGFRSLGRG&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hepahelices.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method for saving sequences in the instance :py:attr:`sequences` to a file in FASTA format.</span>

<span class="sd">        :param filename: output filename (ending .fasta)</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a FASTA formatted file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hepahelices.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hepahelices.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hepahelices.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hepahelices.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.Hepahelices.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AMPngrams"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams">[docs]</a><span class="k">class</span> <span class="nc">AMPngrams</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class for sequence generation from the most prominent ngrams (2, 3, 4grams) found in all natural AMP</span>
<span class="sd">    sequences extracted from the `APD3 &lt;http://aps.unmc.edu/AP/&gt;`_, version August 2016 with 2727 sequences.</span>
<span class="sd">    For all 2, 3 and 4grams, all possible ngrams were generated from all sequences and the top 50 most frequent</span>
<span class="sd">    assembled into a list. Finally, leading and tailing spaces were striped and duplicates as well as ngrams containing</span>
<span class="sd">    spaces were removed.</span>
<span class="sd">    </span>
<span class="sd">    .. versionadded:: v2.4.1</span>
<span class="sd">    </span>
<span class="sd">    .. seealso:: :py:func:`modlamp.core.ngrams_apd()`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="AMPngrams.__init__"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqnum</span><span class="p">,</span> <span class="n">n_min</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="mi">11</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param seqnum: {int} number of sequences to be generated</span>
<span class="sd">        :param n_min: {int} minimum number of ngrams to take for sequence assembly</span>
<span class="sd">        :param n_max: {int} maximum number of ngrams to take for sequence assembly</span>
<span class="sd">        :Example:</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; s = AMPngrams(10)</span>
<span class="sd">        &gt;&gt;&gt; s.generate_sequences()</span>
<span class="sd">        &gt;&gt;&gt; s.sequences</span>
<span class="sd">        [&#39;LAKSLGAGKYGGGKA&#39;, &#39;KAALESCVGGGGC&#39;, &#39;GCSGKAAAAAVG&#39;, &#39;GAASCKPCGEAKGLKVCY&#39;, &#39;IGGGCKITGESCVAGLWCGESTCGCSG&#39;, ...]</span>
<span class="sd">        &gt;&gt;&gt; s.ngrams</span>
<span class="sd">        array([&#39;AGK&#39;, &#39;CKI&#39;, &#39;RR&#39;, &#39;YGGG&#39;, &#39;LSGL&#39;, &#39;RG&#39;, &#39;YGGY&#39;, &#39;PRP&#39;, &#39;LGGG&#39;, ...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ngrams</span> <span class="o">=</span> <span class="n">ngrams_apd</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span> <span class="o">=</span> <span class="n">seqnum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_min</span> <span class="o">=</span> <span class="n">n_min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_max</span> <span class="o">=</span> <span class="n">n_max</span></div>
    
<div class="viewcode-block" id="AMPngrams.generate_sequences"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.generate_sequences">[docs]</a>    <span class="k">def</span> <span class="nf">generate_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate sequences out of APD3 ngrams stored in :py:attr:`ngrams`.</span>
<span class="sd">        </span>
<span class="sd">        :return: list of sequences in :py:attr:`sequences`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqnum</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_max</span><span class="p">)</span>  <span class="c1"># number of ngrams to choose from list to build sequence</span>
            <span class="c1"># build sequence from a random selection of ngrams</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngrams</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngrams</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)]))</span></div>

<div class="viewcode-block" id="AMPngrams.mutate_AA"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.mutate_AA">[docs]</a>    <span class="k">def</span> <span class="nf">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to mutate with **prob** probability a **nr** of positions per sequence randomly.</span>

<span class="sd">        :param nr: number of mutations to perform per sequence</span>
<span class="sd">        :param prob: probability of mutating a sequence</span>
<span class="sd">        :return: In the attribute :py:attr:`sequences`: mutated sequences</span>
<span class="sd">        :Example:</span>

<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;IRSIRRRLSKLARSLGRGARSLGRG&#39;]</span>
<span class="sd">        &gt;&gt;&gt; h.mutate_AA(3,1)</span>
<span class="sd">        &gt;&gt;&gt; h.sequences</span>
<span class="sd">        [&#39;IRSIRRRKSKLARQLGRGFRSLGRG&#39;]</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.mutate_AA()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mutate_AA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span></div>

<div class="viewcode-block" id="AMPngrams.save_fasta"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.save_fasta">[docs]</a>    <span class="k">def</span> <span class="nf">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method for saving sequences in the instance :py:attr:`sequences` to a file in FASTA format.</span>

<span class="sd">        :param filename: output filename (ending .fasta)</span>
<span class="sd">        :param names: {bool} whether sequence names from :py:attr:`names` should be saved as sequence identifiers</span>
<span class="sd">        :return: a FASTA formatted file containing the generated sequences</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.save_fasta()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">save_fasta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="AMPngrams.keep_natural_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.keep_natural_aa">[docs]</a>    <span class="k">def</span> <span class="nf">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences that do not contain natural amino acids. If the sequence contains a character</span>
<span class="sd">        that is not in [&#39;A&#39;,&#39;C&#39;,&#39;D,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;V&#39;,&#39;W&#39;,&#39;Y&#39;].</span>

<span class="sd">        :return: filtered sequence list in the attribute :py:attr:`sequences`. The other attributes are also filtered</span>
<span class="sd">            accordingly.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.keep_natural_aa()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_natural_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="AMPngrams.filter_unnatural"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.filter_unnatural">[docs]</a>    <span class="k">def</span> <span class="nf">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with unnatural amino acids from :py:attr:`sequences`.</span>

<span class="sd">        :return: Filtered sequence list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_unnatural()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_unnatural</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="AMPngrams.filter_duplicates"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.filter_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter duplicates in the sequences from the class attribute :py:attr:`sequences`</span>

<span class="sd">        :return: filtered sequences list in the attribute :py:attr:`sequences`</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_sequences()`</span>

<span class="sd">        .. versionadded:: v2.2.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="AMPngrams.filter_aa"><a class="viewcode-back" href="../../modlamp.html#modlamp.sequences.AMPngrams.filter_aa">[docs]</a>    <span class="k">def</span> <span class="nf">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to filter out sequences with given amino acids in the argument list *aminoacids*.</span>
<span class="sd">        **Dublicates** sequences are removed as well.</span>

<span class="sd">        :param aminoacids: list of amino acids to be filtered</span>
<span class="sd">        :return: filtered list of sequences in the attribute :py:attr:`sequences`.</span>

<span class="sd">        .. seealso:: :func:`modlamp.core.filter_aa()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aminoacids</span><span class="o">=</span><span class="n">aminoacids</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/modlab.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">modlAMP v2.5.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, modlab ETH Zurich, Alex Mueller.
      Last updated on Oct 17, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>